~/workspace$ npx tsx simulate-page-management-kafka.ts
Database connection config: {
  host: undefined,
  database: undefined,
  user: undefined,
  port: undefined
}
Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
Database connection test successful: { now: 2025-05-29T01:02:08.397Z }
🚀 Starting Page Management simulation...

Testing database connection...
✅ Database connection successful
Will process 5 pages...

📝 Processing page 1/5: Nhóm Kinh Doanh Online
🔄 Processing page message: {"pageId":"114501234567890123","pageName":"Nhóm Kinh Doanh Online","pageType":"business","managerId":"114550257830462973","phoneNumber":"0123456789","monetizationEnabled":true}
Found 2 active users for assignment
❌ Error processing page: error: invalid input syntax for type integer: "{"id":"114550257830462973","page_name":"Admin 2973"}"
❌ Failed to process page 1: error: invalid input syntax for type integer: "{"id":"114550257830462973","page_name":"Admin 2973"}"

📝 Processing page 2/5: Cộng Đồng Người Yêu Thể Thao
🔄 Processing page message: {"pageId":"114601234567890124","pageName":"Cộng Đồng Người Yêu Thể Thao","pageType":"community","managerId":"114550257830462974","phoneNumber":"0987654321","monetizationEnabled":false}
Found 2 active users for assignment
❌ Error processing page: error: invalid input syntax for type integer: "{"id":"114550257830462974","page_name":"Admin 2974"}"
❌ Failed to process page 2: error: invalid input syntax for type integer: "{"id":"114550257830462974","page_name":"Admin 2974"}"

📝 Processing page 3/5: Trang Cá Nhân Minh Hoàng
🔄 Processing page message: {"pageId":"114701234567890125","pageName":"Trang Cá Nhân Minh Hoàng","pageType":"personal","managerId":"114550257830462975","phoneNumber":"0345678901","monetizationEnabled":false}
Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
Found 2 active users for assignment
❌ Error processing page: error: invalid input syntax for type integer: "{"id":"114550257830462975","page_name":"Admin 2975"}"
❌ Failed to process page 3: error: invalid input syntax for type integer: "{"id":"114550257830462975","page_name":"Admin 2975"}"

📝 Processing page 4/5: Doanh Nghiệp Công Nghệ Số
🔄 Processing page message: {"pageId":"114801234567890126","pageName":"Doanh Nghiệp Công Nghệ Số","pageType":"business","managerId":"114550257830462976","phoneNumber":"0456789012","monetizationEnabled":true}
Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
Found 2 active users for assignment
❌ Error processing page: error: invalid input syntax for type integer: "{"id":"114550257830462976","page_name":"Admin 2976"}"
❌ Failed to process page 4: error: invalid input syntax for type integer: "{"id":"114550257830462976","page_name":"Admin 2976"}"

📝 Processing page 5/5: Cộng Đồng Học Lập Trình
🔄 Processing page message: {"pageId":"114901234567890127","pageName":"Cộng Đồng Học Lập Trình","pageType":"community","managerId":"114550257830462977","phoneNumber":"0567890123","monetizationEnabled":false}
Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
Found 2 active users for assignment
❌ Error processing page: error: invalid input syntax for type integer: "{"id":"114550257830462977","page_name":"Admin 2977"}"
❌ Failed to process page 5: error: invalid input syntax for type integer: "{"id":"114550257830462977","page_name":"Admin 2977"}"

🎉 Page Management simulation completed!
✅ Success: 0, ❌ Failed: 5

Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
📊 Assignment Distribution:
👤 Nguyễn Hoàng Anh: 0 pages
👤 Nguyễn Thị Khuyên: 0 pages

📈 Total pages in database: 0

✨ Script completed successfully
~/workspace$ npx tsx simulate-page-management-kafka.ts
Database connection config: {
  host: undefined,
  database: undefined,
  user: undefined,
  port: undefined
}
Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
Database connection test successful: { now: 2025-05-29T01:04:43.660Z }
🚀 Starting Page Management simulation...

Testing database connection...
✅ Database connection successful
Will process 5 pages...

📝 Processing page 1/5: Nhóm Kinh Doanh Online
🔄 Processing page message: {"pageId":"114501234567890123","pageName":"Nhóm Kinh Doanh Online","pageType":"business","managerId":"114550257830462973","phoneNumber":"0123456789","monetizationEnabled":true}
Found 2 active users for assignment
❌ Error processing page: error: value "114550257830462980" is out of range for type integer
❌ Failed to process page 1: error: value "114550257830462980" is out of range for type integer

📝 Processing page 2/5: Cộng Đồng Người Yêu Thể Thao
🔄 Processing page message: {"pageId":"114601234567890124","pageName":"Cộng Đồng Người Yêu Thể Thao","pageType":"community","managerId":"114550257830462974","phoneNumber":"0987654321","monetizationEnabled":false}
Found 2 active users for assignment
❌ Error processing page: error: value "114550257830462980" is out of range for type integer
❌ Failed to process page 2: error: value "114550257830462980" is out of range for type integer

📝 Processing page 3/5: Trang Cá Nhân Minh Hoàng
🔄 Processing page message: {"pageId":"114701234567890125","pageName":"Trang Cá Nhân Minh Hoàng","pageType":"personal","managerId":"114550257830462975","phoneNumber":"0345678901","monetizationEnabled":false}
Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
Found 2 active users for assignment
❌ Error processing page: error: value "114550257830462980" is out of range for type integer
❌ Failed to process page 3: error: value "114550257830462980" is out of range for type integer

📝 Processing page 4/5: Doanh Nghiệp Công Nghệ Số
🔄 Processing page message: {"pageId":"114801234567890126","pageName":"Doanh Nghiệp Công Nghệ Số","pageType":"business","managerId":"114550257830462976","phoneNumber":"0456789012","monetizationEnabled":true}
Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
Found 2 active users for assignment
❌ Error processing page: error: value "114550257830462980" is out of range for type integer
❌ Failed to process page 4: error: value "114550257830462980" is out of range for type integer

📝 Processing page 5/5: Cộng Đồng Học Lập Trình
🔄 Processing page message: {"pageId":"114901234567890127","pageName":"Cộng Đồng Học Lập Trình","pageType":"community","managerId":"114550257830462977","phoneNumber":"0567890123","monetizationEnabled":false}
Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
Found 2 active users for assignment
❌ Error processing page: error: value "114550257830462980" is out of range for type integer
❌ Failed to process page 5: error: value "114550257830462980" is out of range for type integer

🎉 Page Management simulation completed!
✅ Success: 0, ❌ Failed: 5

Database connected successfully
Connection config: {
  host: '42.96.40.138',
  database: 'content',
  user: 'postgres',
  port: 5432
}
📊 Assignment Distribution:
👤 Nguyễn Hoàng Anh: 0 pages
👤 Nguyễn Thị Khuyên: 0 pages

📈 Total pages in database: 0

✨ Script completed successfully